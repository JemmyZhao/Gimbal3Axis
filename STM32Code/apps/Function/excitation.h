#ifndef __EXCITATION_H__
#define __EXCITATION_H__

typedef enum EXCITATION_FUNCTION
{
	SINE = 0,
	STEP,
	RECTANGULAR,
	TRIANGULAR,
	TRAPEZOIDAL
} EXCITATION_FUNCTION;

#define FREQ_TABLE_LEN 70

const float log_w_table[FREQ_TABLE_LEN] = {
	6.28318530717959f,
	6.87535893175050f,
	7.52334335681408f,
	8.23239860294941f,
	9.00828043378616f,
	9.85728707847813f,
	10.7863103576465f,
	11.8028916278082f,
	12.9152829984193f,
	14.1325143184623f,
	15.4644664763434f,
	16.9219516081104f,
	18.5168008650849f,
	20.2619604533603f,
	22.1715967247700f,
	24.2612111724020f,
	26.5477662641363f,
	29.0498231356615f,
	31.7876922606946f,
	34.7835983214710f,
	38.0618606178428f,
	41.6490904794587f,
	45.5744072835200f,
	49.8696748316401f,
	54.5697600045985f,
	59.7128157946232f,
	65.3405910127171f,
	71.4987691850835f,
	78.2373393896436f,
	85.6110020429176f,
	93.6796129312473f,
	102.508669090789f,
	112.169840480414f,
	122.741551763372f,
	134.309618920347f,
	146.967945861607f,
	160.819286693011f,
	175.976079823573f,
	192.561360685468f,
	210.709760475479f,
	230.568599025196f,
	252.299080671340f,
	276.077602833712f,
	302.097187923153f,
	330.569050203058f,
	361.724310323434f,
	395.815871445287f,
	433.120472184759f,
	473.940933041841f,
	518.608614549055f,
	567.486107094165f,
	620.970174251566f,
	679.494973514895f,
	743.535580575178f,
	813.611845752894f,
	890.292613888570f,
	974.200341946930f,
	1066.01615181804f,
	1166.48535933161f,
	1276.42352436630f,
	1396.72307116590f,
	1528.36053260270f,
	1672.40447719372f,
	1830.02418321715f,
	2002.49913034148f,
	2191.22938581546f,
	2397.74696952924f,
	2623.72829020231f,
	2871.00775364946f,
	3141.59265358979f};
const float log_t_table[FREQ_TABLE_LEN] = {
	20.0f,
	18.2774030259388f,
	16.7031730686298f,
	15.2645312993676f,
	13.9497995280300f,
	12.7483054052427f,
	11.6502957894687f,
	10.6468575757759f,
	9.72984534361125f,
	8.89181523626182f,
	8.12596453526701f,
	7.42607643927802f,
	6.78646959910564f,
	6.20195199930674f,
	5.66777881194280f,
	5.17961388038775f,
	4.73349452052967f,
	4.32579935363968f,
	3.95321890979090f,
	3.61272876320052f,
	3.30156498142086f,
	3.01720168908776f,
	2.75733056410001f,
	2.51984209978975f,
	2.30280848097925f,
	2.10446793492038f,
	1.92321043008524f,
	1.75756460671785f,
	1.60618583305539f,
	1.46784529026533f,
	1.34141999749527f,
	1.22588369606374f,
	1.12029851879422f,
	1.02380737686821f,
	0.935627002397475f,
	0.855041590238481f,
	0.781396987436416f,
	0.714095383131489f,
	0.652590455822819f,
	0.596382938597738f,
	0.545016566327228f,
	0.498074371928801f,
	0.455175301631701f,
	0.415971121768792f,
	0.380143591986003f,
	0.347401881922810f,
	0.317480210393640f,
	0.290135687906219f,
	0.265146345003498f,
	0.242309330424177f,
	0.221439264455403f,
	0.202366734110941f,
	0.184936917919433f,
	0.169008329159422f,
	0.154451667339364f,
	0.141148768599489f,
	0.128991646515391f,
	0.117881615517062f,
	0.107728489807705f,
	0.0984498512795580f,
	0.0899703804840107f,
	0.0822212452251660f,
	0.0751395418137451f,
	0.0686677844457099f,
	0.0627534385606264f,
	0.0573484943918028f,
	0.0524090772464885f,
	0.0478950913525814f,
	0.0437698943807642f,
	0.0400000000000000f};

const float amp_coef_table[FREQ_TABLE_LEN] = {
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f,
	1.0f};

// for every loop
// Signal y = amp * amp_coef * sin(w*t);

	
	

class Exciter
{
	public:
		void init(EXCITATION_FUNCTION function, float dt);
	  float update(float amp);
	  void start_exciting(void) {exciting = true;}
		bool is_exciting(void) {return exciting;};
	
	private:
		float (*excitation_function)(float w, float time);
	
	  float t;   //sec
	  float dt;  //sec   sample time
	  int freq_cnt;
	  bool exciting;
};



#endif

